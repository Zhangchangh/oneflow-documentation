# Tensors 张量



## 什么是Tensor

​	机器学习中，Tensor是我们离不开的数据形式。神经网络中数据表示，往往是通过称为张量（Tensor）的数据存储库完成的。张量（Tensor）可以视为一个容器，可以容纳N维数据。 我们可以将**Tensor**理解为多维数组，其可以具有任意多的维度，不同**Tensor**可以有不同的**数据类型** (dtype) 和**形状** (shape) 。

​	张量类似于 NumPy 的 ndarray，不同之处在于张量可以在 GPU 或其他硬件加速器上运行。事实上，张量和 NumPy 数组通常可以共享相同的底层内存，从而无需复制数据，除此之外，张量也针对自动微分进行了优化。

​	下面我们将使用Numpy创建一个张量：

```python
import numpy as np
x = np.array([[[1, 4, 7],
               [2, 5, 8],
               [3, 6, 9]],
              [[10, 40, 70],
               [20, 50, 80],
               [30, 60, 90]],
              [[100, 400, 700],
               [200, 500, 800],
               [300, 600, 900]]])
print(x)
print('This tensor is of rank %d' %(x.ndim))
```

```
[[[  1   4   7]
  [  2   5   8]
  [  3   6   9]]
 [[ 10  40  70]
  [ 20  50  80]
  [ 30  60  90]]
 [[100 400 700]
  [200 500 800]
  [300 600 900]]]
This tensor is of rank 3
```





## 如何得到一个Tensor



### 使用Numpy构造（方法似乎还没更新？）

Tensor可以通过 NumPy arrays进行构造。

```python
import oneflow as flow
import numpy as np

data = [[1, 2],[3, 4]]
np_array = np.array(data)
x_np = flow.from_numpy(np_array)
```



### 使用Tensor中的方法构造

我们可以使用oneflow中的Tensor方法构造张量。

```python
import oneflow.experimental as flow
import numpy as np

x = flow.Tensor(np.random.rand([5]))
y = flow.ones_like(x)
```



### 使用算子

我们也可以使用算子进行Tensor的构造。

```python
import oneflow.experimental as flow
import numpy as np
flow.enable_eager_execution()

shape = (2,3,)

ones_tensor = flow.ones(shape)
zeros_tensor = flow.zeros(shape)

print(f"Ones Tensor: \n {ones_tensor} \n")
print(f"Zeros Tensor: \n {zeros_tensor}")
```



## Tensor 的常见属性

 张量属性描述了它们的形状（shape）、数据类型（dtype）和存储它们的设备（device）。 

```python
import oneflow.experimental as flow
import numpy as np
flow.enable_eager_execution()

tensor = flow.Tensor(np.random.randn(2, 6), dtype=flow.float32)

print(f"Shape of tensor: {tensor.shape}")
print(f"Datatype of tensor: {tensor.dtype}")
print(f"Device tensor is stored on: {tensor.device}")
```

**Tensor**的**shape**
shape是 Tensor 的一个重要属性，描述了Tensor的形状，以下我们介绍相关概念：

1. shape：描述了tensor的每个维度上元素的数量
2. ndim： tensor的维度数量，例如vector的 ndim 为1，matrix的 ndim 为2.
3. axis或者dimension：指tensor某个特定的维度




**Tensor**的**dtype**

我们可以通过Tensor.dtype来查看张量的数据类型，目前支持：'bool'，'float16'，'float32'，'float64'，'uint8'，'int8'，'int16'，'int32'，'int64'。



**Tensor**的**device**
我们初始化Tensor时可以通过device来指定其分配的设备位置，可支持的设备位置有两种：CPU/GPU。



## 常见的Tensor操作（算子）

#### 数值计算类

- add(y)

  ```python
  import numpy as np
  import oneflow.experimental as flow
  flow.enable_eager_execution()
  
  # element-wise add
  x = flow.Tensor(np.random.randn(2,3))
  y = flow.Tensor(np.random.randn(2,3))
  out1 = flow.add(x, y).numpy()
  print("out1 shape",out1.shape)
  
  
  # scalar add
  x = 5
  y = flow.Tensor(np.random.randn(2,3))
  out2 = flow.add(x, y).numpy()
  print("out2 shape",out2.shape)
  
  
  # broadcast add
  x = flow.Tensor(np.random.randn(1,1))
  y = flow.Tensor(np.random.randn(2,3))
  out3 = flow.add(x, y).numpy()
  print("out3 shape",out3.shape)
  
  ```

  

- abs(y)

  ```python
  import oneflow.experimental as flow
  import numpy as np
  flow.enable_eager_execution()
  
  x = flow.Tensor(np.array([-1, 2, -3, 4]).astype(np.float32))
  x = flow.abs(x)
  print('Tensor x:',X)
  
  ```

  **是否要罗列所有数值计算类算子**

#### 位置操作类

索引和切片

```python
import oneflow.experimental as flow
import numpy as np
flow.enable_eager_execution()

tensor = flow.ones(4, 4)
print('First row: ',tensor[0])
print('First column: ', tensor[:, 0])
print('Last column:', tensor[..., -1])
tensor[:,1] = 0
print(tensor)
```

连接多个Tensor.

```python
t1 = torch.cat([tensor, tensor, tensor], dim=1)
print(t1)
```





